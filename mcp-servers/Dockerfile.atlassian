# Use the Atlassian MCP server image as base
FROM ghcr.io/sooperset/mcp-atlassian:latest

# Install dependencies as root
USER root
RUN apk add --no-cache jq

# Set working directory
WORKDIR /app

# Copy Atlassian configuration
COPY keys/atlassian.json /app/keys/atlassian.json

# Copy and setup entrypoint script
COPY mcp-servers/entrypoint-atlassian.sh /app/entrypoint-atlassian.sh
RUN chmod +x /app/entrypoint-atlassian.sh

# Expose the MCP server port
EXPOSE 9000

# Use entrypoint script
ENTRYPOINT ["/app/entrypoint-atlassian.sh"]

# Default command with sse transport
CMD ["--transport", "sse", "--port", "9000", "-vv"]